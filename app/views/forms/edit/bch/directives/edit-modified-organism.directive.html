<div>

<div class="innerPageEditForm">

		<span block-region activate="isLoading()" ng-if="isLoading()"></span>
		<div class="registerpage-content">

			<workflow-arrow-buttons on-review-language-change="onReviewLanguageChange(lang)" document="getCleanDocument()" languages="document.header.languages" hide-timer="false" tab="tab"
			 validation-report="validationReport" on-post-close="onPostClose()" on-error="onError(error, errorCode)"
			 on-post-publish="onPostPublishOrRequest(data)" on-pre-publish="onPrePublish()" on-pre-save-draft="onPreSaveDraft()"
			 on-post-save-draft="onPostSaveDraft(data)" on-post-request="onPostPublishOrRequest(data)" on-pre-request="onPreRequest()"
			 data-container="{{container}}" is-dialog="{{isDialog}}" document-type="{{type}}">
				<edit-form>
					<form class="editForm mt-2" name="editForm">
						<div>

							<section>
								<div class="no-shadow bg-white">
									<legend>{{::('editModifiedOrganismT.generalInfo'|$translate)}}</legend>
									<div class="row">
										<div class="col-xs-12">
											<div class="km-control-group" name="header.languages" required caption="{{::('editModifiedOrganismT.languageToPublish'|$translate)}}">
												<div class="indent">
													<div km-form-languages multiple required name="header.languages" ng-model="document.header.languages"></div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</section>

							<section>
								<div class="no-shadow bg-white">
									<legend>{{::('editModifiedOrganismT.identityLMO'|$translate)}}</legend>
									<div class="row">
										<div class="col-sm-12">
											<div class="km-control-group"  name="identity" caption="{{::('editModifiedOrganismT.LMOName'|$translate)}}">
												<div class="help-block">{{::('editModifiedOrganismT.LMONameInfo'|$translate)}}</div>
												<div km-textbox-ml name="identity"  ng-model="document.identity" locales="document.header.languages"></div>
											</div>
										</div>
										<div class="col-sm-12">
											<div class="km-control-group" required name="transformationEvent" caption="{{::('editModifiedOrganismT.transformationEvent'|$translate)}}">
												<div class="help-block">{{::('editModifiedOrganismT.transformationEventInfo'|$translate)}}</div>
												<input type="text" class="form-control" name="transformationEvent" required ng-model="document.transformationEvent"/>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" name="hasUniqueIdentification" required caption="{{::('editModifiedOrganismT.hasUniqueIdentification'|$translate)}}">
												<div class="help-block">{{::('editModifiedOrganismT.hasUniqueIdentificationInfo'|$translate)}} <a rel="noopener" href="/kb/tags/lmo-gene-orga/LMO-Unique-Identifiers-UIDs-/619c55400c1ff000011c1c28">https://bch.cbddev.xyz/en/kb/tags/lmo-gene-orga/LMO-Unique-Identifiers-UIDs-/619c55400c1ff000011c1c28</a>.</div>
												<div km-yes-no required ng-model="document.hasUniqueIdentification" locales="document.header.languages"></div>
											</div>
										</div>
										<div class="col-sm-12" ng-if="document.hasUniqueIdentification">
											<div class="km-control-group" required name="uniqueIdentification" caption="{{::('editModifiedOrganismT.uniqueIdentification'|$translate)}}">
												<input type="text" class="form-control" name="uniqueIdentification" required ng-model="document.uniqueIdentification"
													ng-change="lookupDetections()"/>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" required name="developers" caption="{{::('editModifiedOrganismT.developer'|$translate)}}">	
												<div document-selector ng-model="document.developers" caption="Contact" question="developers"
														on-build-query="onContactQuery(searchText)" allow-new="true" allow-new-schema="contact"></div>
											</div>
										</div>
										<div class="col-sm-12">
											<div class="km-control-group" required name="description" caption="{{::('editModifiedOrganismT.description'|$translate)}}">
												<div km-rich-textbox rows="4" name="description" required ng-model="document.description" locales="document.header.languages"></div>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" required name="recipientOrganisms" caption="{{::('editModifiedOrganismT.recipientOrganisms'|$translate)}}">	
												<div class="help-block">{{::('editModifiedOrganismT.recipientOrganismsInfo'|$translate)}}</div>
												<div document-selector required ng-model="document.recipientOrganisms" caption="{{::('editModifiedOrganismT.recipientOrganismsTitle'|$translate)}}" question="recipientOrganisms"
														on-build-query="onRecipientOrganismsQuery(searchText)" allow-new="true" allow-new-schema="organism,modifiedOrganism"></div>
											</div>
										</div>

										<div class="col-sm-12">
											<div class="km-control-group"  name="recipientOrganismCollectionPoint" caption="{{::('editModifiedOrganismT.recipientOrganismCollectionPoint'|$translate)}}">
												<div km-textbox-ml name="recipientOrganismCollectionPoint"  ng-model="document.recipientOrganismCollectionPoint" locales="document.header.languages"></div>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" name="linkedModifiedOrganisms" caption="{{::('editModifiedOrganismT.linkedModifiedOrganisms'|$translate)}}">	
												<div class="help-block">{{::('editModifiedOrganismT.linkedModifiedOrganismsInfo'|$translate)}}</div>
												<div document-selector ng-model="document.linkedModifiedOrganisms" question="linkedModifiedOrganism"
															on-build-query="onBuildQuery(searchText, 'modifiedOrganism')" allow-new="true" allow-new-schema="modifiedOrganism"></div>
											</div>
										</div>
									</div>
								</div>
							</section>
							

							<section>
								<div class="no-shadow bg-white">
									<legend>{{::('editModifiedOrganismT.modificationProcess'|$translate)}}</legend>
									<div class="row">
										<div class="col-sm-12">
											<div class="km-control-group" required name="vector" caption="{{::('editModifiedOrganismT.vector'|$translate)}}">
												<div class="help-block">{{::('editModifiedOrganismT.vectorInfo'|$translate)}}</div>
												<div km-textbox-ml name="vector"  ng-model="document.vector" locales="document.header.languages"></div>
											</div>
										</div>
										<div class="col-sm-12">
											<div class="km-control-group" required name="techniqueUsed" caption="{{::('editModifiedOrganismT.techniqueUsed'|$translate)}}">
												<div km-term-check name="techniqueUsed" required ng-model="document.techniqueUsed"
													 terms="options.techniqueUsed" binding-type="term[]" locales="document.header.languages"></div>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" required name="genes" caption="{{::('editModifiedOrganismT.genes'|$translate)}}">	
												<div class="help-block">{{::('editModifiedOrganismT.genesInfo'|$translate)}}</div>
												<div document-selector ng-model="document.genes" question="genes" ng-change="onModifiedGeneChange(document.genes)"
															caption="Genetic element" on-build-query="onBuildQuery(searchText, 'dnaSequence')" allow-new="true" allow-new-schema="dnaSequence">
													<selected-records>
														<div ng-include="'lmo-reference-display'" onload="docSelector=$parent"></div>
													</selected-records>
												</div>			
											</div>
										</div>
										<div class="col-sm-12">
											<div class="km-control-group" name="geneConstructs" caption="{{::('editModifiedOrganismT.geneConstructs'|$translate)}}">
												<lmo-construct ng-model="document.geneConstructs" ng-change="onConstructChange()"></lmo-construct>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" name="geneNotes" caption="{{::('editModifiedOrganismT.geneNotes'|$translate)}}">	
												<div class="help-block">{{::('editModifiedOrganismT.geneNotesInfo'|$translate)}} “<i>{{::('editModifiedOrganismT.epsps'|$translate)}}</i> {{::('editModifiedOrganismT.proteinCoding'|$translate)}} <i>{{::('editModifiedOrganismT.35S'|$translate)}}</i> {{::('editModifiedOrganismT.promoterAnd'|$translate)}} <i>{{::('editModifiedOrganismT.nos'|$translate)}}</i> {{::('editModifiedOrganismT.terminator'|$translate)}}”.</div>
												<div km-rich-textbox name="geneNotes" rows="4"  ng-model="document.geneNotes" locales="document.header.languages"></div>	
											</div>
										</div>
									</div>
								</div>
							</section>
	
							
							<section>
								<div class="no-shadow bg-white">
									<legend>{{::('editModifiedOrganismT.LMOCharacteristics'|$translate)}}</legend>
									<div class="row">
										<!-- <div class="col-xs-12">
											<div class="km-control-group" name="isGeneEdited" required
												caption="Was this LMO produced through a gene editing technique?">
												<div km-yes-no required ng-model="document.isGeneEdited" locales="document.header.languages">
												</div>
											</div>
										</div> -->
										<div class="col-sm-12">
											<div  block-region activate="loadingGeneTraits" block-text="{{::('editModifiedOrganismT.updatingTrait'|$translate)}}">
												<div class="km-control-group" required name="traits" caption="{{::('editModifiedOrganismT.modifiedTraits'|$translate)}}">												
													<traits-selector ng-model="document.traits" locales="document.header.languages"></traits-selector>													
												</div>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" name="affectedGenes"
												caption="{{::('editModifiedOrganismT.affectedGenes'|$translate)}}">
												<div class="help-block">{{::('editModifiedOrganismT.affectedGenesInfo'|$translate)}}</div>
												<div document-selector ng-model="document.affectedGenes" question="affectedGenes"
														caption="Genetic element" on-build-query="onBuildQuery(searchText, 'dnaSequence')" allow-new="true" allow-new-schema="dnaSequence">
													<selected-records>
														<div ng-include="'lmo-reference-display'" onload="docSelector=$parent"></div>
													</selected-records>
												</div>
											</div>
										</div>
										<div class="col-xs-12">
											<div class="km-control-group" name="affectedGeneNotes"
												caption="{{::('editModifiedOrganismT.affectedGeneNotes'|$translate)}}">
												<div km-rich-textbox name="affectedGeneNotes" ng-model="document.affectedGeneNotes"
													locales="document.header.languages" rows="4"></div>
											</div>
										</div>
										<div class="col-sm-12">
											<div class="km-control-group" name="commonUses" caption="{{::('editModifiedOrganismT.commonUses'|$translate)}}">
												<div class="help-block">{{::('editModifiedOrganismT.commonUsesInfo'|$translate)}}</div>
												<div km-term-check name="commonUses" required ng-model="document.commonUses"
													terms="options.commonUses" binding-type="term[]" locales="document.header.languages"></div>
											</div>
										</div>
									</div>
								</div>
							</section>
							<section>
								<div class="no-shadow bg-white">
									<legend>{{::('editModifiedOrganismT.dtectionMethod'|$translate)}}</legend>
									<div class="row">
										<div class="col-sm-12">
											<div class="help-block">
												{{::('editModifiedOrganismT.dtectionMethodInfo'|$translate)}}
											</div>
											<div class="km-control-group" name="externalLinks" caption="{{::('editModifiedOrganismT.externalLinks'|$translate)}}">
												<div km-link name="detectionMethodLinks" ng-model="document.detectionMethodLinks" allow-link="true" allow-file="true"
													identifier="document.header.identifier" ></div>
												<div km-link name="externalLinks" ng-model="externalLinks" ng-if="externalLinks" allow-link="false" allow-file="false" identifier="document.header.identifier"></div>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-sm-12">
											<div class="km-control-group" name="detectionMethod" caption="{{::('editModifiedOrganismT.additionalInformation'|$translate)}}">
												<div km-rich-textbox ng-model="document.detectionMethod" rows="4" placeholder="" locales="document.header.languages"></div>
											</div>
										</div>
									</div>
								</div>
							</section>
							<section>
								<div class="no-shadow bg-white">
									<legend>{{::('editModifiedOrganismT.additionalInformation'|$translate)}}</legend>
									<div class="row">
										<div class="col-sm-12">
											<div class="km-control-group" name="address" caption="{{::('editModifiedOrganismT.relevantInformation'|$translate)}}">
												<div class="help-block">{{::('editModifiedOrganismT.relevantInformationInfo'|$translate)}}</div>
												<div km-rich-textbox ng-model="document.relevantInformation" rows="4" placeholder="" locales="document.header.languages"></div>
											</div>
										</div>
									</div>

									<div class="row">
										<div class="col-sm-12">
											<div class="km-control-group" name="relevantDocuments" caption="{{::('editModifiedOrganismT.relevantDocuments'|$translate)}}">
												<div class="help-block">
													{{::('editModifiedOrganismT.relevantDocumentsInfo'|$translate)}}
												</div>
												<div km-link name="relevantDocuments" ng-model="document.relevantDocuments" allow-link="true" allow-file="true"
												 identifier="document.header.identifier"></div>
											</div>
										</div>
									</div>
								</div>
							</section>
							<section>
							<legend>{{::('editModifiedOrganismT.notes'|$translate)}}</legend>

								<div class="row">
									<div class="col-sm-12">
										<div class="km-control-group" name="notes">
											<div class="help-block">{{::('editModifiedOrganismT.notesInfo'|$translate)}}</div>
											<div km-notes name="notes" ng-model="document.notes"></div>
										</div>
									</div>
								</div>
							</section>

						</div>
					</form>
				</edit-form>
				<review-form>
					<div view-modified-organism ng-model="review.document" locale="review.locale" allow-drafts="true"></div>
				</review-form>
			</workflow-arrow-buttons>
		</div>
	</div>
	<div id="constructSection">
		<script type="text/ng-template" trados-translation="true" id="geneConstructModal">
			<lmo-construct ng-model="geneConstruct" close-dialog="closeDialog(updatedConstruct)"></lmo-construct>
		</script>
		<script type="text/ng-template" trados-translation="true" id="lmo-reference-display">			
			<table class="table" style="padding-bottom:3px;width:100%;margin-top:5px;">
				<tr ng-repeat="doc in docSelector.model"  >
					<td style="margin-bottom:15px;width:15px;">
						<a rel="noopener" translation-url  class="btn btn-default" ng-click="$parent.$parent.$parent.removeDocument(doc);" class="link color-red">
							<i class="fa fa-times"></i></a>
					</td>
					<td class="mb-4">
						<div view-record-reference ng-model="doc.identifier" locale="locale" hide-schema="true"></div>
					</td>
				</tr>
			</table>
		</script>
	</div>
</div>