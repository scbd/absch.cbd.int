<div>

    <div>
        <div ng-show="binding">
            <style> table.lmo-transcript{ display: inline!important; } </style>
			<div class="km-value">
                <table class="table">
                    <tr ng-repeat="construct in binding" style="margin-bottom:5px;">
                        <td style="vertical-align: middle;width:3%"><a rel="noopener" title="编辑构造" ng-href="#" ng-click="openContructDialog(construct, $index)"><i class="fa fa-edit"></i></a> <a rel="noopener" title="删除构造" ng-href="#" ng-click="deleteConstruct($index)"><i class="fa fa-trash-o"></i></a> <a rel="noopener" title="上移" ng-if="!$first" ng-href="#" ng-click="moveUp($index)"><i class="fa fa-arrow-up"></i></a> <a rel="noopener" title="下移" ng-if="!$last" ng-href="#" ng-click="moveDown($index)"><i class="fa fa-arrow-down"></i></a></td>
                        <td>
                            <view-lmo-gene ng-model="construct"></view-lmo-gene>
                        </td>
                    </tr>
                </table>
			</div>
		</div>

        <button type="button" class="btn btn-primary" ng-click="openContructDialog()">添加构造</button>
    
    </div>

    <script type="text/ng-template" id="gene-construct-dialog" trados-translation="true">

        <style>/** * dnd-list 列表应该始终一个 min-height（最小高度），*否则您将无法在其空时放入其中 */ .基因构造 ul { min-height: 42px; padding-left: 0px; } /** * dndDraggingSource 类将被用于*拖动操作的源元素。隐藏其的意义在于，可以让用户感觉到 * 自己确实在移动它。*/ .gene-construct ul .dndDraggingSource { display: none; } /** * 当用户在其上方拖动时，* 带 .dndPlaceholder 类的元素将 * 被添加到 dnd-list 列表。*/ .gene-construct ul .dndPlaceholder { background-color: #ddd; display: block; min-height: 42px; } .gene-construct ul li { background-color: #fff; border: 1px solid #ddd; border-top-right-radius: 4px; border-top-left-radius: 4px; display: block; padding: 10px 15px; margin-bottom: -1px; } /** * 用绿色显示选中的元素 */ .gene-construct ul li.selected { background-color: #dff0d8; color: #3c763d; } /***************************** Dropzone Styling *****************************/ /** * nd-list 列表应该始终一个 min-height（最小高度），*否则您将无法在其空时放入其中 */ .gene-construct .dropzone ul { min-height: 42px; margin: 0px; padding-left: 0px; } .gen-construct .dropzone li { display: block; } /** * 在拖动操作中减少元素的不透明度。即便元素很巨大，这可以让用户 * 看到其所放下元素的位置。在拖动操作过程中，* 会自动设置 .dndDragging 类。*/ .gene-construct .dropzone .dndDragging { opacity: 0.7; } /** * dndDraggingSource 类将被用于*拖动操作的源元素。*/ .gene-construct .dropzone .dndDraggingSource { opacity: 0.5; } /** * 当用户在其上方拖动时，* 带 .dndPlaceholder 类的元素将 * 作为 dnd-list 列表的子列表添加。*/ .gene-construct .dropzone .dndPlaceholder { background-color: #ddd !important; display: block; min-height: 42px; } .gene-construct .dropzone .itemlist { min-height: 120px !important; } .gene-construct .dropzone .itemlist > li { border: none; float: left; height: 50px; margin: 5px; padding: 3px; } .gene-construct .dropzone .itemlist > li.dndPlaceholder { width: 150px; } .gene-construct .dropzone .container-element { margin: 10px; } .gene-construct .trashcan ul { list-style: none; padding-left: 0px; } .gene-construct .trashcan img { -webkit-filter: grayscale(100%); -moz-filter: grayscale(100%); filter: grayscale(100%); } .gene-construct .trashcan .dndDragover img { -webkit-filter: none; -moz-filter: none; filter: none; } .gene-construct .trashcan .dndPlaceholder { display: none; }</style>
        <div class="modal-header">
            <h3 class="modal-title">基因构造</h3>
        </div>
        <div class="modal-body" >   
            <div class="help-info">请使用鼠标拖动一个形状，将其添加到一个丢放位置的构件</div>
            <div class="gene-construct">
                <div class="dropzone">
                    <div class="row">
                        <div class="col-sm-8">             
                            <div class="container-element">
                                <ul class="itemlist">

                                    <li ng-repeat="item in constructOptions" dnd-draggable="item" dnd-type="'item'"
                                        dnd-effect-allowed="copy" dnd-dragend="moved($index,'elements')" dnd-moved="constructOptions.splice($index, 1)">
                                        <div ng-include="'gene-construct'" onload="showAdd=false">

                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-sm-4 float-end">       
                            <div class="trashcan">   
                                <div class="help-info">拖动该形状到此处，以移除构件</div>                             
                                <ul dnd-list="[]">
                                    <li><img src="https://bch.cbd.int/bch/images/lmoconstruct/trash-over.png"></li>
                                </ul>
                            </div>
                        </div>
                        <hr />
                        <div class="col-sm-12"><strong>放下位置</legend>                
                            <div class="container-element" style="border:1px solid #eee">
                                <ul dnd-list="newConstruct" class="itemlist">
                                    <li ng-repeat="item in newConstruct" dnd-draggable="item" dnd-type="'item'" dnd-effect-allowed="move"
                                        dnd-dragend="moved($index,'dropLocation')" dnd-moved="newConstruct.splice($index, 1)">
                                        <div ng-include="'gene-construct'" onload="showAdd=true">
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" aria-label="Close" ng-click="closeDialog()" ng-disabled="loading||forTour">取消</button>
            <button type="button" class="btn btn-primary float-start" aria-label="Save" ng-click="saveConstruct()" >保存</button>   
        </div>

    </script>
    <script type="text/ng-template" id="gene-construct"  trados-translation="true">
        <table cellspacing="0px" class="lmo-transcript {{item.type}}">                
            <tr>
                <td class="left" >&nbsp;</td>
                <td class="middle">
                    <div ng-show="!item.gene"><span ng-if="item.type=='senseStart'"    >转录开始</span> <span ng-if="item.type=='sense'"         >转录片段</span> <span ng-if="item.type=='senseStop'"     >转录停止</span> <span ng-if="item.type=='antisenseStart'">转录开始</span> <span ng-if="item.type=='antisense'"     >转录片段</span> <span ng-if="item.type=='antisenseStop'" >转录停止</span></div>

                         <div ng-if="showAdd" document-selector ng-model="item.selectedGene" question="dnaSequence" caption="（意义）" type="radio"
                                on-build-query="onDnaSequenceQuery(searchText)" filter="true" ng-change="geneSelected(item)" allow-new="true" allow-new-schema="dnaSequence">
                                <select-records><a rel="noopener" ng-show="!$parent.$parent.item.gene" ng-href="#" ng-click="$parent.openAddDialog();">选择基因</a> <a rel="noopener" ng-show="$parent.$parent.item.gene"  ng-href="#" ng-click="$parent.openAddDialog();" ng-bind="$parent.$parent.item.gene.body.name|lstring:locale"></a></select-records>
                                <selected-records>
                                    <div ng-show="$parent.$parent.item.gene">#<span ng-bind="$parent.$parent.item.gene.documentID"></span> &nbsp;<input type="number" ng-model="item.size" style="width:50px" min="0"/>KB</div>
                                </selected-records>
                            </div><span ng-if="!showAdd" ng-bind="(item.subType)"></span></div>
                </td>
                <td class="right">&nbsp;</td>
            </tr>
        </table>
    </script>

</div>